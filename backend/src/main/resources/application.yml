server:
  port: 8100
  servlet:
    multipart:
      max-file-size: 500MB
      max-request-size: 500MB
      enabled: true
      file-size-threshold: 2KB
      location: ${java.io.tmpdir}
      resolve-lazily: false
  tomcat:
    max-http-form-post-size: 500MB
    max-swallow-size: 500MB
    connection-timeout: 60000
    max-connections: 8192
    accept-count: 100
    max-threads: 200
    min-spare-threads: 10


spring:
  application:
    name: iot-platform-backend
  
  servlet:
    multipart:
      max-file-size: 500MB
      max-request-size: 500MB
      enabled: true
      file-size-threshold: 2KB
      location: ${java.io.tmpdir}
      resolve-lazily: false

  # datasource:
  #   url: jdbc:postgresql://localhost:5432/iotplatform
  #   driver-class-name: org.postgresql.Driver
  #   username: ${DB_USERNAME:superuser}
  #   password: ${DB_PASSWORD:Vivek@1234}
  datasource:
    url: jdbc:postgresql://localhost:5432/iotplatform
    driver-class-name: org.postgresql.Driver
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:123}

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        hbm2ddl:
          auto: update
        jdbc:
          batch_size: 20
        order_inserts: true
        order_updates: true

  sql:
    init:
      mode: always
      continue-on-error: true
      schema-locations: classpath:schema.sql

  redis:
    host: localhost
    port: 6379
    timeout: 2000ms

  mail:
    host: smtp.gmail.com
    port: 587
    username: ${EMAIL_USERNAME:}
    password: ${EMAIL_PASSWORD:}
    properties:
      mail:
        smtp:
          auth: true
          starttls:
            enable: true

# JWT Configuration
jwt:
  secret: ${JWT_SECRET:mySecretKey123456789012345678901234567890}
  expiration: 31536000000 # 365 days in ms (effectively never expires for this use case)

# InfluxDB Configuration
influxdb:
  url: ${INFLUX_URL:http://localhost:8086}
  token: ${INFLUX_TOKEN:my-token}
  org: ${INFLUX_ORG:iot-platform}
  bucket: ${INFLUX_BUCKET:telemetry}

# MQTT Configuration
mqtt:
  broker-url: ${MQTT_BROKER_URL:tcp://localhost:1883}
  client-id: iot-platform-backend
  username: ${MQTT_USERNAME:}
  password: ${MQTT_PASSWORD:}

# OpenAI Configuration
openai:
  api-key: ${OPENAI_API_KEY:}

# File Upload Configuration
file:
  upload-dir: ${FILE_UPLOAD_DIR:./uploads}
  max-size: 500MB
  allowed-types: pdf,PDF

# App-specific file configuration
app:
  file:
    max-size: 524288000  # 500MB in bytes

# PDF Processing Configuration
pdf:
  processing:
    base-url: http://20.57.36.66:8000
    max-file-size: 524288000  # 500MB in bytes (updated to match server config)
    connection-timeout: 30000  # 30 seconds
    read-timeout: 60000  # 60 seconds
    max-retries: 3
    retry-delay: 1000  # 1 second
    async:
      core-pool-size: 5
      max-pool-size: 10
      queue-capacity: 25
      thread-name-prefix: pdf-processing-
      keep-alive-seconds: 60

# Maintenance Notification Scheduler Configuration
maintenance:
  scheduler:
    enabled: true
    cron: "0 0 6 * * ?"  # Every day at 6:00 AM
    organization-id: "default-org"  # Default organization ID for notifications
  
  # Maintenance Status Update Scheduler Configuration
  status-updater:
    enabled: true
    cron: "0 0 2 * * ?"  # Every day at 2:00 AM (before notification scheduler)

# Conversation API Configuration
conversation:
  api:
    base-url: "http://20.57.36.66:8100/api/chat"
    max-retries: 3
    retry-delay: 1000  # 1 second

# Logging
logging:
  level:
    com.iotplatform: DEBUG
    org.springframework.security: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
    org.springframework.web: DEBUG
    org.springframework.data.jpa: DEBUG
    org.springframework.web.multipart: DEBUG
    org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%-5level] %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/iot-platform.log
    max-size: 10MB
    max-history: 30
